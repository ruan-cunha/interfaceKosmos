{"ast":null,"code":"\"use strict\";\n\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nexports.__esModule = true;\nexports.off = exports.on = exports.emit = exports.TYPE_UNHANDLED_REJECTION = exports.TYPE_UNHANDLED_ERROR = exports.TYPE_REFFRESH = exports.TYPE_BUILD_ERROR = exports.TYPE_BUILD_OK = void 0;\nexports.TYPE_BUILD_OK = 'build-ok';\nexports.TYPE_BUILD_ERROR = 'build-error';\nexports.TYPE_REFFRESH = 'fast-refresh';\nexports.TYPE_UNHANDLED_ERROR = 'unhandled-error';\nexports.TYPE_UNHANDLED_REJECTION = 'unhandled-rejection';\nvar handlers = new Set();\nvar queue = [];\n\nfunction drain() {\n  // Draining should never happen synchronously in case multiple handlers are\n  // registered.\n  setTimeout(function () {\n    var _loop_1 = function () {\n      var ev = queue.shift();\n      handlers.forEach(function (handler) {\n        return handler(ev);\n      });\n    };\n\n    while ( // Until we are out of events:\n    Boolean(queue.length) && // Or, if all handlers removed themselves as a result of handling the\n    // event(s)\n    Boolean(handlers.size)) {\n      _loop_1();\n    }\n  }, 1);\n}\n\nfunction emit(ev) {\n  queue.push(Object.freeze(__assign({}, ev)));\n  drain();\n}\n\nexports.emit = emit;\n\nfunction on(fn) {\n  if (handlers.has(fn)) {\n    return false;\n  }\n\n  handlers.add(fn);\n  drain();\n  return true;\n}\n\nexports.on = on;\n\nfunction off(fn) {\n  if (handlers.has(fn)) {\n    handlers[\"delete\"](fn);\n    return true;\n  }\n\n  return false;\n}\n\nexports.off = off;","map":{"version":3,"sources":["../../src/internal/bus.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;AAEa,OAAA,CAAA,aAAA,GAAgB,UAAhB;AACA,OAAA,CAAA,gBAAA,GAAmB,aAAnB;AACA,OAAA,CAAA,aAAA,GAAgB,cAAhB;AACA,OAAA,CAAA,oBAAA,GAAuB,iBAAvB;AACA,OAAA,CAAA,wBAAA,GAA2B,qBAA3B;AA2Bb,IAAI,QAAQ,GAAyB,IAAI,GAAJ,EAArC;AACA,IAAI,KAAK,GAAe,EAAxB;;AAEA,SAAS,KAAT,GAAc;AACZ;AACA;AACA,EAAA,UAAU,CAAC,YAAA;;AAQP,UAAM,EAAE,GAAG,KAAK,CAAC,KAAN,EAAX;AACA,MAAA,QAAQ,CAAC,OAAT,CAAiB,UAAC,OAAD,EAAQ;AAAK,eAAA,OAAO,CAAP,EAAO,CAAP;AAAW,OAAzC;;;AARF,YACE;AACA,IAAA,OAAO,CAAC,KAAK,CAAC,MAAP,CAAP,IACA;AACA;AACA,IAAA,OAAO,CAAC,QAAQ,CAAC,IAAV,CALT,EAKwB;;AAIvB;AACF,GAXS,EAWP,CAXO,CAAV;AAYD;;AAED,SAAgB,IAAhB,CAAqB,EAArB,EAAiC;AAC/B,EAAA,KAAK,CAAC,IAAN,CAAW,MAAM,CAAC,MAAP,CAAa,QAAA,CAAA,EAAA,EAAM,EAAN,CAAb,CAAX;AACA,EAAA,KAAK;AACN;;AAHD,OAAA,CAAA,IAAA,GAAA,IAAA;;AAKA,SAAgB,EAAhB,CAAmB,EAAnB,EAAsC;AACpC,MAAI,QAAQ,CAAC,GAAT,CAAa,EAAb,CAAJ,EAAsB;AACpB,WAAO,KAAP;AACD;;AAED,EAAA,QAAQ,CAAC,GAAT,CAAa,EAAb;AACA,EAAA,KAAK;AACL,SAAO,IAAP;AACD;;AARD,OAAA,CAAA,EAAA,GAAA,EAAA;;AAUA,SAAgB,GAAhB,CAAoB,EAApB,EAAuC;AACrC,MAAI,QAAQ,CAAC,GAAT,CAAa,EAAb,CAAJ,EAAsB;AACpB,IAAA,QAAQ,CAAC,QAAD,CAAR,CAAgB,EAAhB;AACA,WAAO,IAAP;AACD;;AAED,SAAO,KAAP;AACD;;AAPD,OAAA,CAAA,GAAA,GAAA,GAAA","sourceRoot":"","sourcesContent":["\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nexports.__esModule = true;\nexports.off = exports.on = exports.emit = exports.TYPE_UNHANDLED_REJECTION = exports.TYPE_UNHANDLED_ERROR = exports.TYPE_REFFRESH = exports.TYPE_BUILD_ERROR = exports.TYPE_BUILD_OK = void 0;\nexports.TYPE_BUILD_OK = 'build-ok';\nexports.TYPE_BUILD_ERROR = 'build-error';\nexports.TYPE_REFFRESH = 'fast-refresh';\nexports.TYPE_UNHANDLED_ERROR = 'unhandled-error';\nexports.TYPE_UNHANDLED_REJECTION = 'unhandled-rejection';\nvar handlers = new Set();\nvar queue = [];\nfunction drain() {\n    // Draining should never happen synchronously in case multiple handlers are\n    // registered.\n    setTimeout(function () {\n        var _loop_1 = function () {\n            var ev = queue.shift();\n            handlers.forEach(function (handler) { return handler(ev); });\n        };\n        while (\n        // Until we are out of events:\n        Boolean(queue.length) &&\n            // Or, if all handlers removed themselves as a result of handling the\n            // event(s)\n            Boolean(handlers.size)) {\n            _loop_1();\n        }\n    }, 1);\n}\nfunction emit(ev) {\n    queue.push(Object.freeze(__assign({}, ev)));\n    drain();\n}\nexports.emit = emit;\nfunction on(fn) {\n    if (handlers.has(fn)) {\n        return false;\n    }\n    handlers.add(fn);\n    drain();\n    return true;\n}\nexports.on = on;\nfunction off(fn) {\n    if (handlers.has(fn)) {\n        handlers[\"delete\"](fn);\n        return true;\n    }\n    return false;\n}\nexports.off = off;\n//# sourceMappingURL=bus.js.map"]},"metadata":{},"sourceType":"script"}